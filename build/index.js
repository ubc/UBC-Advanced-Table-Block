(()=>{"use strict";const e=window.wp.element,t=window.lodash;!function(l,o,a,n,s){n=wp.blockEditor||wp.editor;const{__}=l,{Component:r,Fragment:c}=a,{registerBlockType:i,createBlock:d}=o,{InspectorControls:h,BlockControls:v,RichText:b,PanelColorSettings:m,useBlockProps:p}=n,{PanelBody:u,Icon:g,BaseControl:C,RangeControl:S,SelectControl:y,ToggleControl:w,TextControl:I,Button:f,ToolbarGroup:z,ToolbarButton:x,DropdownMenu:E,Tooltip:k}=s,A=(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"2 2 22 22"},(0,e.createElement)("path",{d:"M3 3v18h18V3H3zm8 16H5v-6h6v6zm0-8H5V5h6v6zm8 8h-6v-6h6v6zm0-8h-6V5h6v6z"}),(0,e.createElement)("path",{d:"M0 0h24v24H0z",fill:"none"}));let H=null,M="";const R="data:image/png;base64,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";class B extends r{constructor(){super(...arguments),this.state={initRow:3,initCol:3,selectedCell:null,rangeSelected:null,multiSelected:null,sectionSelected:null,updated:!1},this.calculateRealColIndex=this.calculateRealColIndex.bind(this),this.isMultiSelected=this.isMultiSelected.bind(this),this.isRangeSelected=this.isRangeSelected.bind(this)}componentWillMount(){const{attributes:e,setAttributes:t}=this.props,l=advancedTableBlock.atbsettings;!0!==e.changed&&("object"==typeof l&&null!==l&&Object.keys(l).map((t=>{"boolean"==typeof e[t]?e[t]=!!l[t]:e[t]=l[t]})),t({changed:!0}))}componentDidMount(){this.calculateRealColIndex("head")}componentDidUpdate(){const{isSelected:e}=this.props,{selectedCell:t,updated:l}=this.state;!e&&t&&this.setState({selectedCell:null,rangeSelected:null,multiSelected:null}),l&&(this.calculateRealColIndex(),this.setState({updated:!1}))}createTable(){const{setAttributes:e}=this.props,{initRow:l,initCol:o}=this.state;return this.setState({updated:!0}),e({body:(0,t.times)(parseInt(l),(()=>({cells:(0,t.times)(parseInt(o),(()=>({content:""})))})))})}isMultiSelected(){const{multiSelected:e}=this.state;return e&&e.length>1}isRangeSelected(){const{rangeSelected:e}=this.state;return e&&e.toCell}calculateRealColIndex(){const{attributes:e,setAttributes:t}=this.props;["head","body","foot"].forEach((l=>{if(!e[l].length)return null;const o=e[l].map(((t,o)=>({cells:t.cells.map(((a,n)=>{a.cI=n;for(let s=0;s<o;s++)for(let r=0;r<e[l][s].cells.length;r++)if(e[l][s].cells[r]&&e[l][s].cells[r].colSpan&&e[l][s].cells[r].rowSpan&&s+parseInt(e[l][s].cells[r].rowSpan)>o)if(0===n)e[l][s].cells[r].cI<=a.cI&&(a.cI+=parseInt(e[l][s].cells[r].colSpan));else{const o=isNaN(parseInt(t.cells[n-1].colSpan))?0:parseInt(t.cells[n-1].colSpan);(e[l][s].cells[r].cI===t.cells[n-1].cI+1||e[l][s].cells[r].cI<=t.cells[n-1].cI+o)&&(a.cI+=parseInt(e[l][s].cells[r].colSpan))}for(let e=0;e<n;e++)t.cells[e]&&t.cells[e].colSpan&&(a.cI+=parseInt(t.cells[e].colSpan)-1);return a}))})));t({[l]:o})}))}insertRow(e){const{selectedCell:t,sectionSelected:l}=this.state;if(!t)return null;const{attributes:o,setAttributes:a}=this.props,n=o[l],{rowIndex:s}=t,r=jQuery.extend(!0,{},n[s]);r.cells.map((e=>(e.content="",e))),r.cells=r.cells.filter((e=>!e.rowSpan));const c=[...n.slice(0,s+e),r,...n.slice(s+e)].map(((e,t)=>({cells:e.cells.map((e=>(e.rowSpan&&t<=s&&t+parseInt(e.rowSpan)-1>=s&&(e.rowSpan=parseInt(e.rowSpan)+1),e)))})));this.setState({selectedCell:null,sectionSelected:null,updated:!0}),a({[l]:c})}deleteRow(){const{selectedCell:e,sectionSelected:t}=this.state;if(!e)return null;const{attributes:l,setAttributes:o}=this.props,a=l[t],{rowIndex:n}=e,s=a.map(((e,t)=>({cells:e.cells.map((e=>{if(e.rowSpan&&t<=n&&parseInt(e.rowSpan)+t>n&&(e.rowSpan=parseInt(e.rowSpan)-1,t===n)){const l=a[t+1].cells.findIndex((t=>t.cI===e.cI||t.cI>e.cI));a[t+1].cells.splice(l,0,e)}return e}))})));if(this.setState({selectedCell:null,sectionSelected:null,updated:!0}),s.length<2)return alert(__("At least 1 row of current section must present.","advanced-table-block")),!1;o({[t]:s.filter(((e,t)=>t!==n))})}insertColumn(e){const{selectedCell:t}=this.state;if(!t)return null;const{attributes:l,setAttributes:o}=this.props,{cI:a}=t;let n=0;this.setState({selectedCell:null,updated:!0}),["head","body","foot"].forEach((t=>o({[t]:l[t].map((t=>{if(n>0)return n--,t;let l=t.cells.findIndex(((e,l)=>e.cI===a||t.cells[l+1]&&t.cells[l+1].cI>a));if(-1===l&&(l=t.cells.length-1),t.cells[l].colSpan&&t.cells[l].cI<a+e&&t.cells[l].cI+parseInt(t.cells[l].colSpan)>a+e)return t.cells[l].colSpan++,t.cells[l].rowSpan&&(n=parseInt(t.cells[l].rowSpan)-1),t;{let o=e;return t.cells[l].cI>a&&1===e?o=0:t.cells[l].cI<a&&0===e&&(o=1),{cells:[...t.cells.slice(0,l+o),{content:""},...t.cells.slice(l+o)]}}}))})))}deleteColumn(){const{selectedCell:e}=this.state;if(!e)return null;const{attributes:t,setAttributes:l}=this.props,{cI:o}=e;let a=0;this.setState({selectedCell:null,updated:!0}),["head","body","foot"].forEach((e=>l({[e]:t[e].map((e=>{if(a>0)return a--,e;const t=e.cells.findIndex(((t,l)=>t.cI===o||e.cells[l+1]&&e.cells[l+1].cI>o));return e.cells[t].rowSpan&&(a=parseInt(e.cells[t].rowSpan)-1),e.cells[t].colSpan?(e.cells[t].colSpan--,e.cells[t].colSpan<=1&&delete e.cells[t].colSpan,e):{cells:e.cells.filter(((e,l)=>l!==t))}}))})))}mergeCells(){const{rangeSelected:e,sectionSelected:t}=this.state;if(!this.isRangeSelected())return null;const{attributes:l,setAttributes:o}=this.props,{fromCell:a,toCell:n}=e,s=l[t],r=s[a.rowIdx].cells[a.colIdx],c=s[n.rowIdx].cells[n.colIdx],i=void 0===r.colSpan?0:parseInt(r.colSpan)-1,d=void 0===r.rowSpan?0:parseInt(r.rowSpan)-1,h=void 0===c.colSpan?0:parseInt(c.colSpan)-1,v=void 0===c.rowSpan?0:parseInt(c.rowSpan)-1,b=Math.min(a.rowIdx,n.rowIdx),m=Math.max(a.rowIdx+d,n.rowIdx+v),p=Math.min(a.RCI,n.RCI),u=Math.max(a.RCI+i,n.RCI+h);o({[t]:s.map(((e,t)=>t<b||t>m?e:{cells:e.cells.map(((e,l)=>{if(l===Math.min(a.colIdx,n.colIdx)&&t===Math.min(a.rowIdx,n.rowIdx)){const t=Math.abs(m-b)+1,l=Math.abs(u-p)+1;return{...e,rowSpan:t>1?t:void 0,colSpan:l>1?l:void 0}}return e})).filter(((e,l)=>e.cI<p||l===Math.min(a.colIdx,n.colIdx)&&t===Math.min(a.rowIdx,n.rowIdx)||e.cI>u))}))}),this.setState({selectedCell:null,sectionSelected:null,rangeSelected:null,updated:!0})}splitMergedCells(){const{selectedCell:e,sectionSelected:l}=this.state;if(!e)return null;const{attributes:o,setAttributes:a}=this.props,{colIndex:n,rowIndex:s,cI:r}=e,c=o[l][s].cells[n].colSpan?parseInt(o[l][s].cells[n].colSpan):1,i=o[l][s].cells[n].rowSpan?parseInt(o[l][s].cells[n].rowSpan):1;o[l][s].cells[n].colSpan=void 0,o[l][s].cells[n].rowSpan=void 0,a({[l]:o[l].map(((e,l)=>{if(l>=s&&l<s+i){const o=e.cells.findIndex((e=>e.cI>=r));let a=0;return l===s&&(a=1),{cells:[...e.cells.slice(0,o+a),...(0,t.times)(c-a,(()=>({content:""}))),...e.cells.slice(o+a)]}}return e}))}),this.setState({selectedCell:null,sectionSelected:null,updated:!0})}static parseStyles(e){return"string"!=typeof e?e:e.split(";").filter((e=>e.split(":")[0]&&e.split(":")[1])).map((e=>[e.split(":")[0].trim().replace(/-./g,(e=>e.substr(1).toUpperCase())),e.split(":")[1].trim()])).reduce(((e,t)=>({...e,[t[0]]:t[1]})),{})}getCellStyles(e){const{selectedCell:t,sectionSelected:l}=this.state,o=this.props.attributes[l];if(!t)return;const{rowIndex:a,colIndex:n}=t;if("borderColor"===e)return o[a].cells[n].borderColorSaved;const s=B.parseStyles(o[a].cells[n].styles);if("object"==typeof s){let t=s[e];return t&&"number"!=typeof t&&t.indexOf("px")&&(t=s[e].replace(/px/g,"")),void 0===t&&"borderStyle"===e?"solid":t}return void 0!==s&&s[e],"undefined"==typeof convertedStyles&&"borderStyle"===e?"solid":void 0}updateCellsStyles(e){const{selectedCell:t,rangeSelected:l,multiSelected:o,sectionSelected:a}=this.state;if(!t&&!this.isRangeSelected()&&!this.isMultiSelected())return null;const{attributes:n,setAttributes:s}=this.props,{rowIndex:r,colIndex:c}=t,i=n[a];let d,h,v,b;if(this.isRangeSelected()){const{fromCell:e,toCell:t}=l,o=i[e.rowIdx].cells[e.colIdx],a=i[t.rowIdx].cells[t.colIdx],n=void 0===o.colSpan?0:parseInt(o.colSpan)-1,s=void 0===o.rowSpan?0:parseInt(o.rowSpan)-1,r=void 0===a.colSpan?0:parseInt(a.colSpan)-1,c=void 0===a.rowSpan?0:parseInt(a.rowSpan)-1;d=Math.min(e.rowIdx,t.rowIdx),h=Math.max(e.rowIdx+s,t.rowIdx+c),v=Math.min(e.RCI,t.RCI),b=Math.max(e.RCI+n,t.RCI+r)}const m=i.map(((t,l)=>!this.isRangeSelected()&&!this.isMultiSelected()&&l!==r||this.isRangeSelected()&&(l<d||l>h)||this.isMultiSelected()&&-1===o.findIndex((e=>e.rowIndex===l))?t:{cells:t.cells.map(((t,a)=>{if(!this.isRangeSelected()&&!this.isMultiSelected()&&a===c||this.isRangeSelected()&&t.cI>=v&&t.cI<=b||this.isMultiSelected()&&o.findIndex((e=>e.colIndex===a&&e.rowIndex===l))>-1)if(t.styles=B.parseStyles(t.styles),e.borderColor)t.styles.borderTopColor&&(t.styles={...t.styles,borderTopColor:e.borderColor}),t.styles.borderRightColor&&(t.styles={...t.styles,borderRightColor:e.borderColor}),t.styles.borderBottomColor&&(t.styles={...t.styles,borderBottomColor:e.borderColor}),t.styles.borderLeftColor&&(t.styles={...t.styles,borderLeftColor:e.borderColor}),t.borderColorSaved=e.borderColor;else if(e.setBorder){const o=t.borderColorSaved||"#000",a=t.colSpan?parseInt(t.colSpan)-1:0,n=t.rowSpan?parseInt(t.rowSpan)-1:0;switch(e.setBorder){case"top":t.styles={...t.styles,borderTopColor:o};break;case"right":t.styles={...t.styles,borderRightColor:o};break;case"bottom":t.styles={...t.styles,borderBottomColor:o};break;case"left":t.styles={...t.styles,borderLeftColor:o};break;case"all":t.styles={...t.styles,borderTopColor:o,borderRightColor:o,borderBottomColor:o,borderLeftColor:o};break;case"none":t.styles={...t.styles,borderTopColor:void 0,borderRightColor:void 0,borderBottomColor:void 0,borderLeftColor:void 0};break;case"vert":t.cI===v?t.styles={...t.styles,borderRightColor:o}:t.cI+a===b?t.styles={...t.styles,borderLeftColor:o}:t.styles={...t.styles,borderRightColor:o,borderLeftColor:o};break;case"horz":t.styles=l===d?{...t.styles,borderBottomColor:o}:l+n===h?{...t.styles,borderTopColor:o}:{...t.styles,borderTopColor:o,borderBottomColor:o};break;case"inner":t.styles=l===d?{...t.styles,borderBottomColor:o}:l+n===h?{...t.styles,borderTopColor:o}:{...t.styles,borderTopColor:o,borderBottomColor:o},t.cI===v?t.styles={...t.styles,borderRightColor:o}:t.cI+a===b?t.styles={...t.styles,borderLeftColor:o}:t.styles={...t.styles,borderRightColor:o,borderLeftColor:o};break;case"outer":l===d?t.styles={...t.styles,borderTopColor:o}:l+n===h&&(t.styles={...t.styles,borderBottomColor:o}),t.cI===v?t.styles={...t.styles,borderLeftColor:o}:t.cI+a===b&&(t.styles={...t.styles,borderRightColor:o})}}else t.styles={...t.styles,...e};return t}))}));s({[i]:m})}updateCellContent(e,t=null){const{selectedCell:l,sectionSelected:o}=this.state;if(!l&&!t)return null;let a,n;t?(a=t.rowIndex,n=t.colIndex):(a=l.rowIndex,n=l.colIndex);const{attributes:s,setAttributes:r}=this.props,c=s[o].map(((t,l)=>l!==a?t:{cells:t.cells.map(((t,l)=>l!==n?t:{...t,content:e}))}));r({[o]:c})}toggleSection(e){const{attributes:t,setAttributes:l}=this.props,{sectionSelected:o}=this.state,{body:a}=t,n=[{cells:a[0].cells.map((e=>({cI:e.cI,colSpan:e.colSpan})))}];return o===e&&this.setState({selectedCell:null,sectionSelected:null}),t[e].length?l({[e]:[]}):l("caption"!==e?{[e]:n}:{[e]:[{cells:[{cI:0,colSpan:3,content:""}]}]})}renderSection(t){const{attributes:l}=this.props,{selectedCell:o,multiSelected:a,rangeSelected:n,sectionSelected:s}=this.state;return"caption"===t?(0,e.createElement)(b,{tagName:"em",value:l[t][0].cells[0].content,key:0,className:"wp-block-table__cell-content",onChange:e=>{M=e,this.updateCellContent(e,o||{rowIndex:0,colIndex:0,cI:0,section:t})},unstableOnFocus:()=>{this.updateCellContent(M,o),this.setState({selectedCell:{rowIndex:0,colIndex:0,cI:0,section:t},sectionSelected:t})}}):l[t].map((({cells:r},c)=>(0,e.createElement)("tr",{key:c},r.map((({content:r,styles:i,colSpan:d,rowSpan:h,cI:v},m)=>{const p={rowIndex:c,colIndex:m,cI:v,section:t};let u=o&&o.rowIndex===c&&o.colIndex===m&&s===t;if(this.isRangeSelected()){const{fromCell:e,toCell:o}=n;if(l[s][e.rowIdx]&&l[s][o.rowIdx]){const a=l[s][e.rowIdx].cells[e.colIdx],n=l[s][o.rowIdx].cells[o.colIdx],r=void 0===a.colSpan?0:parseInt(a.colSpan)-1,i=void 0===a.rowSpan?0:parseInt(a.rowSpan)-1,d=void 0===n.colSpan?0:parseInt(n.colSpan)-1,h=void 0===n.rowSpan?0:parseInt(n.rowSpan)-1;u=c>=Math.min(e.rowIdx,o.rowIdx)&&c<=Math.max(e.rowIdx+i,o.rowIdx+h)&&v>=Math.min(e.RCI,o.RCI)&&v<=Math.max(e.RCI+r,o.RCI+d)&&t===s}}this.isMultiSelected()&&(u=a.findIndex((e=>e.rowIndex===c&&e.colIndex===m))>-1&&a[0].section===t);const g=[u&&"cell-selected"].filter(Boolean).join(" ");return i=B.parseStyles(i),(0,e.createElement)("td",{key:m,className:g,style:i,colSpan:d,rowSpan:h,onClick:e=>{if(e.shiftKey){if(!n)return;if(!n.fromCell)return;const{fromCell:e}=n;if(t!==e.section)return void alert(__("Cannot select multiple cells from difference sections!","advanced-table-block"));const l={rowIdx:c,colIdx:m,RCI:v,section:t};this.setState({rangeSelected:{fromCell:e,toCell:l},multiSelected:null})}else if(e.ctrlKey||e.metaKey){const e=a||[],l=e.findIndex((e=>e.rowIndex===c&&e.colIndex===m));if(e.length&&t!==e[0].section)return void alert(__("Cannot select multiple cells from difference sections!","advanced-table-block"));-1===l?e.push(p):e.splice(l,1),this.setState({multiSelected:e,rangeSelected:null})}else this.setState({rangeSelected:{fromCell:{rowIdx:c,colIdx:m,RCI:v,section:t}},multiSelected:[p]})}},(0,e.createElement)(b,{className:"wp-block-table__cell-content",value:r,onChange:e=>{H&&clearTimeout(H),M=e,H=this.updateCellContent(e,o)},onFocus:()=>{this.setState({selectedCell:p,sectionSelected:t})}}))})))))}render(){const{attributes:t,setAttributes:l,className:o}=this.props,{head:a,body:n,foot:s,maxWidth:r,tableCollapsed:i,hasFixedLayout:d,isPreview:b,caption:p}=t,{initRow:H,initCol:M,selectedCell:B,rangeSelected:V,multiSelected:D}=this.state,P=r||void 0,N=B?n[B.rowIndex].cells[B.colIndex]:null;if(!n.length)return b?(0,e.createElement)("img",{alt:__("Advanced Table","advanced-table-block"),width:"100%",src:R}):(0,e.createElement)(c,null,(0,e.createElement)("div",{className:"advgb-init-table"},(0,e.createElement)(g,{icon:()=>A})," ",(0,e.createElement)("span",{className:"ubcatb-insert-title"},"Advanced Table"),(0,e.createElement)("div",{className:"ubcatb-controls-container"},(0,e.createElement)("p",{className:"ubcatb-block-description"},__("Add an accessible, advanced table block for displaying tabular data.","advanced-table-block")," ",(0,e.createElement)("em",null,__("Hint: Hold the shift key to select multiple cells.","advanced-table-block"))),(0,e.createElement)(I,{type:"number",className:"ubcatb-insert-field",label:__("Column Count","advanced-table-block"),value:M,onChange:e=>this.setState({initCol:e}),min:"1"}),(0,e.createElement)(I,{type:"number",className:"ubcatb-insert-field",label:__("Row Count","advanced-table-block"),value:H,onChange:e=>this.setState({initRow:e}),min:"1"}),(0,e.createElement)(f,{className:"ubcatb-insert-field",isPrimary:!0,onClick:()=>this.createTable()},__("Create Table","advanced-table-block")))));const T=[{icon:"table-row-before",title:__("Add Row Before","advanced-table-block"),isDisabled:!B||this.isRangeSelected()||this.isMultiSelected(),onClick:()=>this.insertRow(0)},{icon:"table-row-after",title:__("Add Row After","advanced-table-block"),isDisabled:!B||this.isRangeSelected()||this.isMultiSelected(),onClick:()=>this.insertRow(1)},{icon:"table-row-delete",title:__("Delete Row","advanced-table-block"),isDisabled:!B||this.isRangeSelected()||this.isMultiSelected(),onClick:()=>this.deleteRow()},{icon:"table-col-before",title:__("Add Column Before","advanced-table-block"),isDisabled:!B||this.isRangeSelected()||this.isMultiSelected(),onClick:()=>this.insertColumn(0)},{icon:"table-col-after",title:__("Add Column After","advanced-table-block"),isDisabled:!B||this.isRangeSelected()||this.isMultiSelected(),onClick:()=>this.insertColumn(1)},{icon:"table-col-delete",title:__("Delete Column","advanced-table-block"),isDisabled:!B||this.isRangeSelected()||this.isMultiSelected(),onClick:()=>this.deleteColumn()},{icon:(0,e.createElement)("svg",{width:"20",height:"20",viewBox:"4 2 18 18",className:"dashicon"},(0,e.createElement)("path",{fill:"none",d:"M0,0h24v24H0V0z"}),(0,e.createElement)("path",{d:"M4,5v13h17V5H4z M14,7v9h-3V7H14z M6,7h3v9H6V7z M19,16h-3V7h3V16z"})),title:__("Split Merged Cells","advanced-table-block"),isDisabled:!B||N&&!N.rowSpan&&!N.colSpan||this.isRangeSelected()||this.isMultiSelected(),onClick:()=>this.splitMergedCells()},{icon:(0,e.createElement)("svg",{width:"20",height:"20",className:"dashicon",viewBox:"2 2 22 22"},(0,e.createElement)("path",{fill:"none",d:"M0,0h24v24H0V0z"}),(0,e.createElement)("polygon",{points:"21,18 2,18 2,20 21,20 21,18"}),(0,e.createElement)("path",{d:"M19,10v4H4v-4H19 M20,8H3C2.45,8,2,8.45,2,9v6c0,0.55,0.45,1,1,1h17c0.55,0,1-0.45,1-1V9C21,8.45,20.55,8,20,8L20,8z"}),(0,e.createElement)("polygon",{points:"21,4 2,4 2,6 21,6 21,4"})),title:__("Merge Cells","advanced-table-block"),isDisabled:!this.isRangeSelected(),onClick:()=>this.mergeCells()}];let Q=[{title:__("Border Top","advanced-table-block"),icon:(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},(0,e.createElement)("path",{d:"M7 21h2v-2H7v2zm0-8h2v-2H7v2zm4 0h2v-2h-2v2zm0 8h2v-2h-2v2zm-8-4h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2v-2H3v2zm0-4h2V7H3v2zm8 8h2v-2h-2v2zm8-8h2V7h-2v2zm0 4h2v-2h-2v2zM3 3v2h18V3H3zm16 14h2v-2h-2v2zm-4 4h2v-2h-2v2zM11 9h2V7h-2v2zm8 12h2v-2h-2v2zm-4-8h2v-2h-2v2z"}),(0,e.createElement)("path",{d:"M0 0h24v24H0z",fill:"none"})),onClick:()=>this.updateCellsStyles({setBorder:"top"})},{title:__("Border Right","advanced-table-block"),icon:(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},(0,e.createElement)("path",{d:"M7 21h2v-2H7v2zM3 5h2V3H3v2zm4 0h2V3H7v2zm0 8h2v-2H7v2zm-4 8h2v-2H3v2zm8 0h2v-2h-2v2zm-8-8h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm8 8h2v-2h-2v2zm4-4h2v-2h-2v2zm4-10v18h2V3h-2zm-4 18h2v-2h-2v2zm0-16h2V3h-2v2zm-4 8h2v-2h-2v2zm0-8h2V3h-2v2zm0 4h2V7h-2v2z"}),(0,e.createElement)("path",{d:"M0 0h24v24H0z",fill:"none"})),onClick:()=>this.updateCellsStyles({setBorder:"right"})},{title:__("Border Bottom","advanced-table-block"),icon:(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},(0,e.createElement)("path",{d:"M9 11H7v2h2v-2zm4 4h-2v2h2v-2zM9 3H7v2h2V3zm4 8h-2v2h2v-2zM5 3H3v2h2V3zm8 4h-2v2h2V7zm4 4h-2v2h2v-2zm-4-8h-2v2h2V3zm4 0h-2v2h2V3zm2 10h2v-2h-2v2zm0 4h2v-2h-2v2zM5 7H3v2h2V7zm14-4v2h2V3h-2zm0 6h2V7h-2v2zM5 11H3v2h2v-2zM3 21h18v-2H3v2zm2-6H3v2h2v-2z"}),(0,e.createElement)("path",{d:"M0 0h24v24H0z",fill:"none"})),onClick:()=>this.updateCellsStyles({setBorder:"bottom"})},{title:__("Border Left","advanced-table-block"),icon:(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},(0,e.createElement)("path",{d:"M11 21h2v-2h-2v2zm0-4h2v-2h-2v2zm0-12h2V3h-2v2zm0 4h2V7h-2v2zm0 4h2v-2h-2v2zm-4 8h2v-2H7v2zM7 5h2V3H7v2zm0 8h2v-2H7v2zm-4 8h2V3H3v18zM19 9h2V7h-2v2zm-4 12h2v-2h-2v2zm4-4h2v-2h-2v2zm0-14v2h2V3h-2zm0 10h2v-2h-2v2zm0 8h2v-2h-2v2zm-4-8h2v-2h-2v2zm0-8h2V3h-2v2z"}),(0,e.createElement)("path",{d:"M0 0h24v24H0z",fill:"none"})),onClick:()=>this.updateCellsStyles({setBorder:"left"})},{title:__("Border All","advanced-table-block"),icon:(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},(0,e.createElement)("path",{d:"M3 3v18h18V3H3zm8 16H5v-6h6v6zm0-8H5V5h6v6zm8 8h-6v-6h6v6zm0-8h-6V5h6v6z"}),(0,e.createElement)("path",{d:"M0 0h24v24H0z",fill:"none"})),onClick:()=>this.updateCellsStyles({setBorder:"all"})},{title:__("Border None","advanced-table-block"),icon:(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},(0,e.createElement)("path",{d:"M7 5h2V3H7v2zm0 8h2v-2H7v2zm0 8h2v-2H7v2zm4-4h2v-2h-2v2zm0 4h2v-2h-2v2zm-8 0h2v-2H3v2zm0-4h2v-2H3v2zm0-4h2v-2H3v2zm0-4h2V7H3v2zm0-4h2V3H3v2zm8 8h2v-2h-2v2zm8 4h2v-2h-2v2zm0-4h2v-2h-2v2zm0 8h2v-2h-2v2zm0-12h2V7h-2v2zm-8 0h2V7h-2v2zm8-6v2h2V3h-2zm-8 2h2V3h-2v2zm4 16h2v-2h-2v2zm0-8h2v-2h-2v2zm0-8h2V3h-2v2z"}),(0,e.createElement)("path",{d:"M0 0h24v24H0z",fill:"none"})),onClick:()=>this.updateCellsStyles({setBorder:"none"})}];if(this.isRangeSelected()){const t=[{title:__("Border Vertical","advanced-table-block"),icon:(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},(0,e.createElement)("path",{d:"M3 9h2V7H3v2zm0-4h2V3H3v2zm4 16h2v-2H7v2zm0-8h2v-2H7v2zm-4 0h2v-2H3v2zm0 8h2v-2H3v2zm0-4h2v-2H3v2zM7 5h2V3H7v2zm12 12h2v-2h-2v2zm-8 4h2V3h-2v18zm8 0h2v-2h-2v2zm0-8h2v-2h-2v2zm0-10v2h2V3h-2zm0 6h2V7h-2v2zm-4-4h2V3h-2v2zm0 16h2v-2h-2v2zm0-8h2v-2h-2v2z"}),(0,e.createElement)("path",{d:"M0 0h24v24H0z",fill:"none"})),onClick:()=>this.updateCellsStyles({setBorder:"vert"})},{title:__("Border Horizontal","advanced-table-block"),icon:(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},(0,e.createElement)("path",{d:"M3 21h2v-2H3v2zM5 7H3v2h2V7zM3 17h2v-2H3v2zm4 4h2v-2H7v2zM5 3H3v2h2V3zm4 0H7v2h2V3zm8 0h-2v2h2V3zm-4 4h-2v2h2V7zm0-4h-2v2h2V3zm6 14h2v-2h-2v2zm-8 4h2v-2h-2v2zm-8-8h18v-2H3v2zM19 3v2h2V3h-2zm0 6h2V7h-2v2zm-8 8h2v-2h-2v2zm4 4h2v-2h-2v2zm4 0h2v-2h-2v2z"}),(0,e.createElement)("path",{d:"M0 0h24v24H0z",fill:"none"})),onClick:()=>this.updateCellsStyles({setBorder:"horz"})},{title:__("Border Inner","advanced-table-block"),icon:(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},(0,e.createElement)("path",{d:"M3 21h2v-2H3v2zm4 0h2v-2H7v2zM5 7H3v2h2V7zM3 17h2v-2H3v2zM9 3H7v2h2V3zM5 3H3v2h2V3zm12 0h-2v2h2V3zm2 6h2V7h-2v2zm0-6v2h2V3h-2zm-4 18h2v-2h-2v2zM13 3h-2v8H3v2h8v8h2v-8h8v-2h-8V3zm6 18h2v-2h-2v2zm0-4h2v-2h-2v2z"}),(0,e.createElement)("path",{d:"M0 0h24v24H0z",fill:"none"})),onClick:()=>this.updateCellsStyles({setBorder:"inner"})},{title:__("Border Outer","advanced-table-block"),icon:(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},(0,e.createElement)("path",{d:"M13 7h-2v2h2V7zm0 4h-2v2h2v-2zm4 0h-2v2h2v-2zM3 3v18h18V3H3zm16 16H5V5h14v14zm-6-4h-2v2h2v-2zm-4-4H7v2h2v-2z"}),(0,e.createElement)("path",{d:"M0 0h24v24H0z",fill:"none"})),onClick:()=>this.updateCellsStyles({setBorder:"outer"})}];Q=[...Q,...t]}const q=[{icon:"editor-alignleft",title:__("Align left","advanced-table-block"),align:"left"},{icon:"editor-aligncenter",title:__("Align center","advanced-table-block"),align:"center"},{icon:"editor-alignright",title:__("Align right","advanced-table-block"),align:"right"},{icon:"editor-justify",title:__("Align justify","advanced-table-block"),align:"justify"}],L=[{icon:(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},(0,e.createElement)("path",{d:"M8 11h3v10h2V11h3l-4-4-4 4zM4 3v2h16V3H4z"}),(0,e.createElement)("path",{d:"M0 0h24v24H0z",fill:"none"})),title:__("Align top","advanced-table-block"),align:"top"},{icon:(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},(0,e.createElement)("path",{d:"M8 19h3v4h2v-4h3l-4-4-4 4zm8-14h-3V1h-2v4H8l4 4 4-4zM4 11v2h16v-2H4z"}),(0,e.createElement)("path",{d:"M0 0h24v24H0z",fill:"none"})),title:__("Align middle","advanced-table-block"),align:"middle"},{icon:(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},(0,e.createElement)("path",{d:"M16 13h-3V3h-2v10H8l4 4 4-4zM4 19v2h16v-2H4z"}),(0,e.createElement)("path",{d:"M0 0h24v24H0z",fill:"none"})),title:__("Align bottom","advanced-table-block"),align:"bottom"}];return b?(0,e.createElement)("img",{alt:__("Advanced Table","advanced-table-block"),width:"100%",src:R}):(0,e.createElement)(c,null,(0,e.createElement)(v,null,(0,e.createElement)(z,null,(0,e.createElement)(E,{hasArrowIndicator:!0,icon:"editor-table",label:__("Edit Table","advanced-table-block"),controls:T}),(0,e.createElement)(x,{icon:"update",label:__("Refresh table (Use this after using undo or redo)","advanced-table-block"),onClick:()=>this.calculateRealColIndex()}))),(0,e.createElement)(h,null,(0,e.createElement)(u,{title:__("Table Settings","advanced-table-block")},(0,e.createElement)(S,{label:__("Max width in px)","advanced-table-block"),help:__("Set this to 0 to make max-width 100%","advanced-table-block"),min:0,max:1999,value:r,onChange:e=>l({maxWidth:e})}),(0,e.createElement)(w,{label:__("Fixed width table cells","advanced-table-block"),checked:d,onChange:()=>l({hasFixedLayout:!d})}),(0,e.createElement)(w,{label:__("Table header","advanced-table-block"),checked:a&&a.length,onChange:()=>this.toggleSection("head")}),(0,e.createElement)(w,{label:__("Table footer","advanced-table-block"),checked:s&&s.length,onChange:()=>this.toggleSection("foot")}),(0,e.createElement)(w,{label:__("Border collapsed","advanced-table-block"),checked:i,onChange:()=>l({tableCollapsed:!i})}),(0,e.createElement)(w,{label:__("Table caption","advanced-table-block"),checked:p&&p.length,onChange:()=>this.toggleSection("caption")})),(0,e.createElement)(u,{title:__("Cell Settings","advanced-table-block")},(0,e.createElement)(m,{title:__("Color Settings","advanced-table-block"),colorSettings:[{label:__("Background Color","advanced-table-block"),value:this.getCellStyles("backgroundColor"),onChange:e=>this.updateCellsStyles({backgroundColor:e})},{label:__("Text Color","advanced-table-block"),value:this.getCellStyles("color"),onChange:e=>this.updateCellsStyles({color:e})}]}),(0,e.createElement)(u,{title:__("Border","advanced-table-block"),initialOpen:!1},(0,e.createElement)("div",{className:"advgb-border-item-wrapper"},Q.map(((t,l)=>(0,e.createElement)("div",{className:"advgb-border-item",key:l},(0,e.createElement)(k,{text:t.title},(0,e.createElement)("span",{onClick:t.onClick},t.icon)))))),(0,e.createElement)(y,{label:__("Border Style","advanced-table-block"),value:this.getCellStyles("borderStyle"),options:[{label:__("Solid","advanced-table-block"),value:"solid"},{label:__("Dashed","advanced-table-block"),value:"dashed"},{label:__("Dotted","advanced-table-block"),value:"dotted"},{label:__("None","advanced-table-block"),value:"none"}],onChange:e=>this.updateCellsStyles({borderStyle:e})}),(0,e.createElement)(S,{label:__("Border width","advanced-table-block"),value:this.getCellStyles("borderWidth")||0,min:0,max:10,onChange:e=>this.updateCellsStyles({borderWidth:e})}),(0,e.createElement)(m,{title:__("Border Color","advanced-table-block"),colorSettings:[{label:__("Border Color","advanced-table-block"),value:this.getCellStyles("borderColor"),onChange:e=>this.updateCellsStyles({borderColor:e})}]})),(0,e.createElement)(u,{title:__("Padding","advanced-table-block"),initialOpen:!1},(0,e.createElement)(S,{label:__("Padding Top","advanced-table-block"),value:this.getCellStyles("paddingTop")||0,min:0,max:100,onChange:e=>this.updateCellsStyles({paddingTop:e})}),(0,e.createElement)(S,{label:__("Padding Right","advanced-table-block"),value:this.getCellStyles("paddingRight")||0,min:0,max:100,onChange:e=>this.updateCellsStyles({paddingRight:e})}),(0,e.createElement)(S,{label:__("Padding Bottom","advanced-table-block"),value:this.getCellStyles("paddingBottom")||0,min:0,max:100,onChange:e=>this.updateCellsStyles({paddingBottom:e})}),(0,e.createElement)(S,{label:__("Padding Left","advanced-table-block"),value:this.getCellStyles("paddingLeft")||0,min:0,max:100,onChange:e=>this.updateCellsStyles({paddingLeft:e})})),(0,e.createElement)(u,{title:__("Text Alignment","advanced-table-block"),initialOpen:!1},(0,e.createElement)(C,{help:__("Horizontal Align","advanced-table-block")},(0,e.createElement)(z,{controls:q.map((e=>{const t=this.getCellStyles("textAlign")===e.align;return{...e,isActive:t,onClick:()=>this.updateCellsStyles({textAlign:t?void 0:e.align})}}))})),(0,e.createElement)(C,{help:__("Vertical Align","advanced-table-block")},(0,e.createElement)(z,{controls:L.map((e=>{const t=this.getCellStyles("verticalAlign")===e.align;return{...e,isActive:t,onClick:()=>this.updateCellsStyles({verticalAlign:t?void 0:e.align})}}))}))))),(0,e.createElement)("table",{className:o,style:{maxWidth:P,borderCollapse:i?"collapse":void 0,tableLayout:d?"fixed":void 0}},!!p.length&&(0,e.createElement)("caption",null,this.renderSection("caption")),!!a.length&&(0,e.createElement)("thead",null,this.renderSection("head")),(0,e.createElement)("tbody",null,this.renderSection("body")),!!s.length&&(0,e.createElement)("tfoot",null,this.renderSection("foot"))))}}i("ubc/advanced-table-block",{title:__("Advanced Table","advanced-table-block"),description:__("An accessible, advanced table block for displaying tabular data.","advanced-table-block"),icon:{src:A,foreground:"undefined"!=typeof advgbBlocks?advgbBlocks.color:void 0},category:"text",keywords:[__("table","advanced-table-block"),__("cell","advanced-table-block"),__("data","advanced-table-block")],attributes:{caption:{type:"array",default:[],source:"query",selector:"caption",query:{cells:{type:"array",default:[],source:"query",selector:"em",query:{content:{source:"html"}}}}},head:{type:"array",default:[],source:"query",selector:"thead tr",query:{cells:{type:"array",default:[],source:"query",selector:"td, th",query:{content:{source:"html"},styles:{type:"string",source:"attribute",attribute:"style"},colSpan:{type:"string",source:"attribute",attribute:"colspan"},borderColorSaved:{type:"string",source:"attribute",attribute:"data-border-color"},scope:{type:"string",source:"attribute",attribute:"scope"}}}}},body:{type:"array",default:[],source:"query",selector:"tbody tr",query:{cells:{type:"array",default:[],source:"query",selector:"td",query:{content:{source:"html"},styles:{type:"string",source:"attribute",attribute:"style"},colSpan:{type:"string",source:"attribute",attribute:"colspan"},rowSpan:{type:"string",source:"attribute",attribute:"rowspan"},borderColorSaved:{type:"string",source:"attribute",attribute:"data-border-color"}}}}},foot:{type:"array",default:[],source:"query",selector:"tfoot tr",query:{cells:{type:"array",default:[],source:"query",selector:"td, th",query:{content:{source:"html"},styles:{type:"string",source:"attribute",attribute:"style"},colSpan:{type:"string",source:"attribute",attribute:"colspan"},borderColorSaved:{type:"string",source:"attribute",attribute:"data-border-color"}}}}},maxWidth:{type:"number",default:0},hasFixedLayout:{type:"boolean",default:!1},tableCollapsed:{type:"boolean",default:!1},changed:{type:"boolean",default:!1},isPreview:{type:"boolean",default:!1}},example:{attributes:{isPreview:!0}},supports:{align:!0,anchor:!0},styles:[{name:"default",label:__("Default","advanced-table-block"),isDefault:!0},{name:"stripes",label:__("Stripes","advanced-table-block")}],edit:B,save:function({attributes:t}){const{head:l,body:o,foot:a,maxWidth:n,tableCollapsed:s,hasFixedLayout:r,caption:c}=t,i=n||void 0;let d="is-style-stripes"===t.className?" table-striped ":"";function h(l){if("caption"===l){const l=p.save();return(0,e.createElement)(b.Content,{...l,tagName:"em",value:t.caption[0].cells[0].content,placeholder:__("A description of the table"),key:"tcapcon"})}let o="head"===l?"th":"td",a="head"===l?"col":"";return t[l].map((({cells:t},l)=>(0,e.createElement)("tr",{key:l},t.map((({content:t,styles:l,colSpan:n,rowSpan:s,borderColorSaved:r},c)=>(0,e.createElement)(b.Content,{tagName:o,value:t,key:c,style:l,colSpan:n,rowSpan:s,"data-border-color":r,scope:a}))))))}return(0,e.createElement)("table",{className:d+" table ",style:{maxWidth:i,borderCollapse:s?"collapse":void 0,tableLayout:r?"fixed":void 0}},!!c.length&&(0,e.createElement)("caption",null,h("caption")),!!l.length&&(0,e.createElement)("thead",null,h("head")),(0,e.createElement)("tbody",null,h("body")),!!a.length&&(0,e.createElement)("tfoot",null,h("foot")))},transforms:{from:[{type:"block",blocks:["core/table"],transform:e=>d("ubc/advanced-table-block",{body:e.body})}]},deprecated:[]})}(wp.i18n,wp.blocks,wp.element,wp.blockEditor,wp.components)})();